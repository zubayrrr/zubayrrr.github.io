---
created: 1661899873567
desc: ''
id: 9bxkg30e4dyro479iml718l
title: Configuration File
updated: 1661899873567
---
   
### Kubernetes deployment configuration file   
   
If a deployment does not exist, it will be created. If it exists, it will be updated.   
   
`kubectl apply -f deployment.yaml`   
`kubectl apply -f config-file-nginx.yaml`   
   
It is used for creating and configuring K8s clusters. There are 3 parts to it:   
   
1. Metadata   
2. Specification   
   
   - Attributes are specific to the `kind`   
3. Status (auto-generated and added by kubernetes)   
   
   - Kubernetes will compare the desired with the actual state and if the desired state ≠ actual state, K8 will try to fix it.   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655117494/wiki/ipq3mbgswsrb0ufg7hrt.png)   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655117667/wiki/fakkxkxbdvspydlfnd4f.png)   
   
   
- The status is constantly updated, it gets it’s data from `etcd`.   
- The format of the configuration file is [languages.YAML](../devlog/languages.YAML.md) format.   
- The code is stored along with the source code of your application or it can have it's own repository.   
- The configuration file is structured as a "template" or a "blueprint" .   
- The connection is made using "selectors" and "labels".   
- Pods gets the label through the template blueprint.   
- This label is matched by the selector.   
- To get the configuration of a running deployment, use `kubectl get deployment deployment-name -o yaml`   
  - You'll find that a lot of information will be auto-generated by Kubernetes.   
- To copy a deployment you already have, you'll have to remove auto-generated stuff and clean the configuration file before creating a deployment from it.   
- You can use the configuration file to delete a deployment. `kubectl delete -f deployment.yaml`   
   
### Creating a Secret   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655127535/wiki/ag8cc3fib3l5qtkvwasf.png)   
   
When you store values, don’t use plain text, encode them in base64. For example: `echo -n "somevalue" | base64`   
   
`kubectl apply -f secrets.yaml`   
   
Secret once created can be referenced in your deployment configuration files.   
   
Example of secret being referenced:   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655127895/wiki/lmddjxbristzwqipuuy3.png)   
   
### Creating a Service   
   
Deployment and Service can be put in a single file. You don’t define a type unlike an External Service where type is defined because Internal Service or ClusterIP(it gives an internal IP Address) is the default.   
   
Example of a Service configuration   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655128136/wiki/vepvw9yubv8izozijvjo.png)   
   
Reapply the `deployment.yaml` and the newly added Service will also be created.   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655128207/wiki/ljbcr1cfavkzz0lsbjd1.png)   
   
To validate if the Service is attached to the correct Pod, you can run `kubectl describe service service-name` and cross check `endpoints` IP Address with the Pod’s `kubectl get pod -o wide`.   
   
### Creating ConfigMap   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655128682/wiki/mow4k1vejxaungybxje8.png)   
   
ConfigMap must already be created in the K8s cluster before referencing it.   
   
`kubectl apply -f configmap.yaml`   
   
Referencing ConfigMap   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655128847/wiki/odygjn3izkrd8gotfhlq.png)   
   
### Creating an External Service   
   
It is very similar to a typical Service. Internal service also acts like a load balancer but an External Service acts like loan balancer by accepting external request by assigning the service an external [IP Address](../devlog/ip%20address.md).   
   
![](https://res.cloudinary.com/zubayr/image/upload/v1655129162/wiki/gpts0wcs1wrdij7txbfc.png)